{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": { 
        "newStorageAccount": {
            "type":"string",
            "metadate": {
                "description" : "Unique DNS name of the Storage Account for Azure"
            }      
        },
        "storageAccountType": {
          "type": "string",
          "defaultValue": "Standard_LRS",
          "allowedValues": [
            "Standard_LRS",
            "Standard+GRS",
            "Standard_RAGRS",
            "Standard_ZRS",
            "Premium_LRS",
            "Premium_ZRS",
            "Premium_GRS",
            "Premium_RAGRS"
          ],
          "metadata": {
            "description":"Storage type for the VM"
          }
        },
        "location": {
          "type": "string",
          "defaultValue": "[resourceGroup().location]",
          "metadata":{
            "description": "Location of all resources"
          }
        },
        "adminUsername": {
          "type": "string",
          "metadata": {
            "description":"Username for VM's admin account"
          }
        },
        "adminPassowrd" : {
          "type": "securestring",
          "minLength": 8,
          "metadata": {
            "description": "Password for VM's admin account.**use Azure Keyvault**"
          }
        },
        "dnsNameForPublicIP": {
          "type": "string",
          "metadata": {
            "description": "Unique DNS name for Public IP of VM"
          }
        },
        "vmSize": {
            "type": "string",
            "defaultValue": "Basic_A0",
            "allowedValues": [
                "Basic_A0",
                "Standard_A0",
                "Standard_A1",
                "Standard_A2",
                "Standard_"
            ]
        }


    },
    "variables": { 
      "IpAddressPrefix": "172.16.0.0/16",
      "SubnetPrefix":"172.16.6.0/24",
      "SubnetName":"comaVMNet",
      "VirtualNetworkName":"ComaVNet",
      "networkInterface":"vmNic",
      "VnetId":"[resourceId('Microsoft.Network/virtualNetworks',variables('VirtualNetworkName'))]",
      "SubnetRef": "[concat(variables('VnetId'),'/subnets/',variables('SubnetName'))]",
      "publicIpAddressName":"comaPublicIP",
      "publicIpAddressType":"dynamic"
      },
    "resources": [
      {
        "type": "Microsoft.Storage/storageAccounts",
        "name": "[parameters('newStorageAccount')]" ,
        "apiVersion": "2017-10-01",
        "location":"[parameters('location')]",
        "kind": "StorageV2",
        "properties":{
           "sku": "[parameters('storageAccountType')]"
        }  
      },
      {
        "type":"Microsoft.Network/publicIPAddresses",
        "name":"[variables('publicIpAddressName')]",
        "apiVersion": "2017-10-01",
        "location":"[parameters('location')]",
        "properties":{
          "publicIPAlloctionMethod":"[variables('publicIpAddressType')]",
          "dnsSettings":{
            "domainNameLabel": "[variables('publicIpAddressName')]"
          }

        }
      },
      {
        "type":"Microsoft.Network/virtualNetworks",
        "name":"[variables('VirtualNetworkName')]",
        "apiVersion": "2017-10-01",
        "properties":{
          "addressSpace":{
            "addressPrefixes":[
              "[variables('IpAddressPrefix')]"
            ]
          },
          "subnets":[
            {
              "name": "[variables('SubnetName')]",
              "properties":{
                "addressPrefix": "[variables('SubnetPrefix')]"
              }
            }
          ]
        }
      },
      {
        "type": "Microsoft.Network/networkInterfaces",
        "name": "[variables('networkInterface')]",
        "apiVersion": "2017-10-01",
        "location":"[parameters('location')]"
      }
    ],
    "outputs": {  

    }
}